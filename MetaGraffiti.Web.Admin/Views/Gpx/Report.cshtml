@model MetaGraffiti.Web.Admin.Models.GpxViewModel

@Html.Partial("_Gpx")

<div class="row">
	<div class="col-md-6">
		<table class="table table-striped table-sm">
			<tbody>
				@foreach (var cal in Model.ListCalendarEntries(Model.SelectedYear, Model.SelectedMonth))
				{
					<tr class="table-active">
						<td colspan="2">
							<a class="h3" href="/gpx/report/?year=@(Model.SelectedYear)&month=@(cal.Month)">@Model.GetMonth(cal.Month)</a>
							<span class="badge badge-pill badge-info">@cal.Files</span>
						</td>
						<td>Name</td>
						<td>Location</td>
						<td>UTC Timestamp</td>
					</tr>
					var count = 0;
					foreach (var file in Model.ListGpxFiles(cal.Year, cal.Month))
					{
						<tr>
							<td>
								@(++count)
							</td>
							<td>
								<a href="/gpx/display/?id=@(file.MetaData.Uri)">@file.MetaData.Name</a>
							</td>

							@if (file.MetaData != null)
							{
								<td>@file.MetaData.Name</td>
								<td>@file.MetaData.LocationName</td>
								<td>@file.MetaData.Timestamp</td>
							}
							else
							{
								<td colspan="3"></td>
							}
						</tr>
					}
					if (count != cal.Files)
					{
						var errors = cal.Files - count;
						<tr>
							<td colspan="5" class="table-danger text-center">@errors files have errors</td>
						</tr>
					}
				}
			</tbody>
		</table>
	</div>
</div>