@using MetaGraffiti.Web.Admin.Models;
@model TrailViewModel

@Html.Partial("_Nav")


<div class="row">
	<div class="col-sm-4">
		<div class="h3">
			@if (Model.SelectedMonth.HasValue)
			{
				<a href="@TrailViewModel.GetReportUrl(Model.SelectedYear.Value)">@Model.SelectedYear</a>
				<span> \ </span>
				@Model.GetMonth(Model.SelectedMonth)
			}
			else
			{
				@Model.SelectedYear
			}
		</div>
	</div>
	<div class="col-sm-8 text-right">
		@if (Model.SelectedMonth.HasValue)
		{
			<div class="h6">
				@for (int month = 1; month <= 12; month++)
				{
					<a class="@(Model.SelectedMonth == month ? "font-italic" : "")" href="@TrailViewModel.GetReportUrl(Model.SelectedYear.Value, month)">@Model.GetMonth(month)</a>
					<span>&nbsp;</span>
				}
			</div>
		}
		else if (Model.SelectedYear.HasValue)
		{
			<div class="h5">
				@for (var year = Model.FirstDate.Year; year <= Model.LastDate.Year; year++)
				{
					<a class="@(Model.SelectedYear == year ? "font-italic" : "")" href="@TrailViewModel.GetReportUrl(year)">@year</a>
					<span>&nbsp;</span>
				}
			</div>
		}
	</div>
</div>
<hr />

<table class="table table-striped">
	<thead class="table-dark">
		<tr>
			<th>Country</th>
			<th>Region</th>
			<th>Date</th>
			<th>Track</th>
			<th>Tags</th>
			<th class="text-center">Distance</th>
			<th class="text-center">Time</th>
			<th class="text-center">Tracks</th>
			<th class="text-center">Points</th>

		</tr>
	</thead>
	<tbody>
		@foreach (var trail in Model.Trails)
		{
			<tr>
				<td>@trail.Country.Name</td>
				<td>@(trail.Region?.RegionName ?? "")</td>
				<td>@trail.LocalDate.ToString("yyyy-MM-dd")</td>
				<td>
					<div class="h4">
						<a href="@TrailViewModel.GetDisplayUrl(trail.ID)">@trail.Name</a>
					</div>
					<div class="small">@trail.Description</div>
				</td>
				<td>
					@foreach (var tag in trail.AutoTags)
					{
						<span class="badge badge-pill badge-@CssHelper.GetTagCss(tag)">@tag</span>
					}
				</td>
				<td class="text-center">@trail.TotalKilometers.ToString("0.0") km</td>
				<td class="text-center">@trail.ElapsedTimeText</td>
				<td class="text-center">@trail.Tracks.Count</td>
				<td class="text-center">@trail.Tracks.SelectMany(x => x.Points).Count().ToString("#,##0")</td>
			</tr>
		}
	</tbody>
</table>
