@model MetaGraffiti.Web.Admin.Models.GeoViewModel

@Html.Partial("_Nav")

@{
	var l = Model.SelectedLocation;
}


<script src="https://maps.googleapis.com/maps/api/js?key=@(AutoConfig.GoogleMapsApiKey)"></script>
<script src="~/Scripts/_graffiti/googleMaps.js"></script>
<script>
	var _location = @Model.GetJson(Model.SelectedLocation);;

	$(document).ready(function () {
		initMap();

		_location.marker = markPoint(_location.center.lat, _location.center.lng, _location.name);

		drawBounds(_location.bounds, null, '');

		fitBounds(_location.bounds);

		$('#Region').change(function () {
			$('#Region').addClass("is-invalid");
		});
		$(".js-region-lookup").click(function () {
			var id = $('#Region').val();
			console.log(id);

			$.getJSON('/api/regions/' + id)
				.done(function (data) {
					$('#Region').text(data.RegionName);
					$('#Region').removeClass("is-invalid");
					$('#Region').addClass("is-valid");
				})
				.fail(function (jqXHR, textStatus, err) {
					$('#Region').addClass("is-invalid");
				});
		});
	});
</script>

<div id="map-container">
	<div id="map">
	</div>
</div>

<div class="row">
	<div class="col-sm-6">
		<div class="h2">
			Location<span class="h3">: @l.Name</span>
		</div>
		<br />
		<form method="post" action="/geo/location/">
			<input type="hidden" name="ID" value="@l.ID" />

			<div class="row">
				<div class="col">
					<div class="form-group">
						<label for="Name">Name</label>
						<input type="text" class="form-control" name="Name" value="@l.Name">
					</div>
				</div>
				<div class="col">
					<div class="form-group">
						<label for="LocalName">Local Name</label>
						<input type="text" class="form-control" name="LocalName" value="@l.LocalName">
					</div>
				</div>
				<div class="col">
					<div class="form-group">
						<label for="DisplayAs">Display As</label>
						<input type="text" class="form-control" name="DisplayAs" value="@l.DisplayAs">
					</div>
				</div>
			</div>
			<div class="row">
				<div class="col">
					<div class="form-group">
						<label for="Description">Description</label>
						<input type="text" class="form-control" name="Description" value="@l.Description">
					</div>
				</div>
			</div>
			<div class="row">
				<div class="col">
					<div class="form-group">
						<label for="PlaceType">Place Type</label>
						<input type="text" class="form-control" name="PlaceType" value="@l.PlaceType">
					</div>
				</div>
				<div class="col">
					<div class="form-group">
						<label for="PlaceFlags">Flags</label>
						<input type="text" disabled class="form-control" name="PlaceFlags" value="">
					</div>
				</div>
				<div class="col">
					<div class="form-group">
						<label for="IconKey">Icon</label>
						<input type="text" disabled class="form-control" name="IconKey" value="">
					</div>
				</div>
			</div>

			<hr />
			<div class="row">
				<div class="col">
					<div class="form-group">
						<label for="Address">Address</label>
						<input type="text" class="form-control" name="Address" value="@l.Address">
					</div>
				</div>
				<div class="col">
					<div class="form-group">
						<label for="City">City</label>
						<input type="text" class="form-control" name="City" value="@l.City">
					</div>
				</div>
				<div class="col">
					<div class="form-group">
						<label for="Postcode">Postcode</label>
						<input type="text" class="form-control" name="Postcode" value="@l.Postcode">
					</div>
				</div>
			</div>
			<div class="row">
				<div class="col">
					<div class="form-group">
						<label for="Country">Country</label>
						<input type="text" readonly class="form-control" name="Country" value="@l.Country.Name">

						<!--
						<label for="Localities">Localities</label>
						<input type="text" disabled class="form-control" name="Localities" value="@l.Localities">
						-->
					</div>
				</div>
				<div class="col">
					<div class="form-group">
						<label for="Subregions">Subregions</label>
						<input type="text" disabled class="form-control" name="Subregions" value="@l.Subregions">
					</div>
				</div>
				<div class="col">
					<div class="form-group">
						<label for="Region">Region</label>
						<div class="input-group">
							<input type="text" class="form-control @(l.Region == null ? "is-invalid": "is-valid")" id="Region" name="Region" value="@(l.Region?.RegionName??"")">
							<div class="input-group-append">
								<button class="btn btn-outline-secondary js-region-lookup" type="button">Lookup</button>
							</div>
						</div>
					</div>
				</div>
			</div>
			<hr />
			<div class="row">
				<div class="col">
					<div class="form-group">
						<label for="CenterLatitude">Center</label>
						<div class="input-group">
							<input type="text" class="form-control" readonly name="CenterLatitude" placeholder="Latitude" value="@l.Latitude">
							<input type="text" class="form-control" readonly name="CenterLongitude" placeholder="Longitude" value="@l.Longitude">
						</div>
					</div>
				</div>
				<div class="col">
					<div class="form-group">
						<label for="NorthLatitude">North West</label>
						<div class="input-group">
							<input type="text" class="form-control" readonly name="NorthLatitude" placeholder="Latitude" value="@(l.Bounds?.NorthWest.Latitude??null)">
							<input type="text" class="form-control" readonly name="WestLongitude" placeholder="Longitude" value="@(l.Bounds?.NorthWest.Longitude??null)">
						</div>
					</div>
				</div>
				<div class="col">
					<div class="form-group">
						<label for="SouthLatitude">South East</label>
						<div class="input-group">
							<input type="text" class="form-control" readonly name="SouthLatitude" placeholder="Latitude" value="@(l.Bounds?.SouthEast.Latitude??null)">
							<input type="text" class="form-control" readonly name="EastLongitude" placeholder="Longitude" value="@(l.Bounds?.SouthEast.Longitude??null)">
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="col">
					<div class="form-group">
						<label for="PlaceKey">Place Key</label>
						<input type="hidden" name="PlaceKey" value="@l.PlaceKey">
						<input type="text" class="form-control" readonly name="PlaceKeyDisplay" value="@l.PlaceKey">
					</div>
				</div>
				<div class="col">
					<div class="form-group">
						<label for="GoogleKey">Google Key</label>
						<input type="hidden" name="GoogleKey" value="@l.GoogleKey">
						<input type="text" class="form-control" readonly name="GoogleKeyDisplay" value="@l.GoogleKey">
					</div>
				</div>
				<div class="col">
					<div class="form-group">
						<label for="TimezoneKey">Timezone</label>
						<div class="input-group">
							<input type="text" class="form-control" name="TimezoneKey" value="">
							<div class="input-group-append">
								<button class="btn btn-outline-secondary" type="button">Lookup</button>
							</div>
						</div>
					</div>
				</div>
			</div>
			<hr />
			<button class="btn btn-primary" type="submit">Update</button>
		</form>
	</div>
</div>