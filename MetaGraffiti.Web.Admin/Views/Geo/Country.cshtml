@model MetaGraffiti.Web.Admin.Models.GeoViewModel

@Html.Partial("_Nav")
@{
	var c = Model.SelectedCountry;
}

<script src="https://maps.googleapis.com/maps/api/js?key=@(AutoConfig.GoogleMapsApiKey)"></script>
<script src="~/Scripts/_graffiti/googleMaps.js"></script>
<script>
	var _marker = null;
	var _country = [
			{ lat: @c.Bounds.Points[0].Latitude, lng: @c.Bounds.Points[0].Longitude },
			{ lat: @c.Bounds.Points[0].Latitude, lng: @c.Bounds.Points[1].Longitude },
			{ lat: @c.Bounds.Points[1].Latitude, lng: @c.Bounds.Points[1].Longitude },
			{ lat: @c.Bounds.Points[1].Latitude, lng: @c.Bounds.Points[0].Longitude },
			{ lat: @c.Bounds.Points[0].Latitude, lng: @c.Bounds.Points[0].Longitude },
	];

	var _regions = [
		@foreach (var r in c.Regions.OrderBy(x => x.RegionName))
		{
			<text>
			{
				region: "@r.RegionName",
				bounds: [
					{ lat: @r.Bounds.Points[0].Latitude, lng: @r.Bounds.Points[0].Longitude },
					{ lat: @r.Bounds.Points[0].Latitude, lng: @r.Bounds.Points[1].Longitude },
					{ lat: @r.Bounds.Points[1].Latitude, lng: @r.Bounds.Points[1].Longitude },
					{ lat: @r.Bounds.Points[1].Latitude, lng: @r.Bounds.Points[0].Longitude },
					{ lat: @r.Bounds.Points[0].Latitude, lng: @r.Bounds.Points[0].Longitude },
				]
			},</text>
		}
	]

	$(document).ready(function () {
		initMap();

		for (i = 0; i < _regions.length; i++) {
			var color = _trackColors[i % 10];
			showTrack(_regions[i].bounds, color);
			markPoint(_regions[i].bounds[0].lat, _regions[i].bounds[0].lng, _regions[i].region);
			$("table > tbody > tr").eq(i).children().eq(0).css('background-color', color);
		}


		showTrack(_country);
	});
</script>

<div id="map-container">
	<div id="map">
	</div>
</div>

<div class="row">
	<div class="col-sm-6">
		<h2><a href="/geo/countries/">Countries</a> \ @c.Name</h2>
		<table class="table table-striped table-sm">
			<thead class="thead-dark">
				<tr>
					<th class="text-center">#</th>
					<th>Abbr</th>
					<th>Region</th>
					<th>Center</th>
					<th>North West</th>
					<th>South East</th>
				</tr>
			</thead>
			<tbody>
				@{
					var count = 0;
					foreach (var r in c.Regions.OrderBy(x => x.RegionName))
					{
						<tr>
							<td class="text-center">@(++count)</td>
							<td>@r.RegionAbbr</td>
							<td>@r.RegionName</td>
							<td class="small">@r.Center.Latitude.ToString("0.000000") x @r.Center.Longitude.ToString("0.000000")</td>
							<td class="small">@r.Bounds.NorthWest.Latitude.ToString("0.000000") x @r.Bounds.NorthWest.Longitude.ToString("0.000000")</td>
							<td class="small">@r.Bounds.SouthEast.Latitude.ToString("0.000000") x @r.Bounds.SouthEast.Longitude.ToString("0.000000")</td>
						</tr>
					}
				}
			</tbody>
		</table>
	</div>
</div>