@using MetaGraffiti.Web.Admin.Models;
@model XlsViewModel

@Html.Partial("_Nav")

<div class="row">
	<div class="col-md-6">
		@if (Model.RawCount != Model.SelectedRows.Count)
		{
			<div class="alert alert-danger">
				@(Model.RawCount - Model.SelectedRows.Count) places were not able to be parsed.
			</div>
		}
		<table class="table table-striped table-sm">
			<thead class="thead-dark">
				<tr>
					<th class="text-center">#</th>
					<th>Name</th>
					<th>Locality</th>
					<th>Region</th>
					<th>Country</th>
					<th>Location</th>
				</tr>
			</thead>
			@{
				var count = 0;
				foreach (var row in Model.ListRowsOrdered())
				{
					<tr class="@Model.GetRowCss(row)">
						<td class="text-center">@(++count)</td>
						<td><a href="/geo/search/?name=@row.Place.Name @row.Place.Country">@row.Place.Name</a></td>
						<td>@row.Place.Locality</td>
						<td>@row.Place.Region</td>
						<td>@row.Place.Country</td>
						<td>
							@if (row.Location != null)
							{
								<a href="/geo/location/@(row.Location.Key)">@row.Location.Name</a>
								<span>@row.Location.Locality <b>@(row.Location.Region?.RegionName ?? "")</b></span>
							}
						</td>
					</tr>
				}
			}
		</table>
	</div>
	<div class="col-md-6">
	</div>
</div>
