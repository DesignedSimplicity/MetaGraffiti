@using MetaGraffiti.Web.Admin.Models;
@model TopoViewModel

@Html.Partial("_Nav")

<div class="row">
	<div class="col-sm-2">
		<div class="h2">Countries</div>
		<hr />

		@foreach (var country in Model.Countries)
		{
			<div class="h2">
				<a class="topo-color" href="@TopoViewModel.GetCountryUrl(country.Name)">
					@country.Name
				</a>
				<div class="h4 float-right">
					<span class="badge badge-secondary">@Model.GetTrailCount(country)</span>
				</div>				
			</div>

		}
		<br />
		<hr />
		<a href="@TopoViewModel.GetRefreshUrl()" class="btn btn-outline-success"><i class="fas fa-recycle"></i> Refresh Cache</a>
	</div>
	<div class="col-sm-4">
		<div class="h2">Calendar</div>
		<table class="table table-bordered">
			<thead class="thead-dark">
				<tr>
					<th>Year</th>
					@for (var month = 1; month <= 12; month++)
					{
						<th class="text-center">@TextHelper.GetMonth(month, true)</th>
					}
				</tr>
			</thead>
			<tbody>
				@for (var year = Model.LastDate.Year; year >= Model.FirstDate.Year; year--)
				{
					<tr>
						<td class="table-secondary">
							<a class="h4" href="@TopoViewModel.GetReportUrl(year)">
								@year
							</a>
						</td>
						@for (var month = 1; month <= 12; month++)
						{
							var count = Model.GetTrailCount(year, month);
							<td class="text-center @(count > 0 ? "table-success" : "")">
								@if (count > 0)
								{
									<a class="h5" href="@TopoViewModel.GetReportUrl(year, month)">@count</a>
								}
							</td>
						}
					</tr>
				}
			</tbody>
		</table>
	</div>
</div>